{
  "$schema": "../../packages/config/jeju-manifest.schema.json",
  "name": "indexer",
  "displayName": "Network Indexer",
  "version": "1.0.0",
  "type": "core",
  "description": "Blockchain indexer with GraphQL API and web dashboard - indexes all on-chain events for apps",
  "commands": {
    "dev": "bun run dev",
    "build": "bun run build",
    "start": "bun run start",
    "test": "bun run test"
  },
  "ports": {
    "main": 4355,
    "frontend": 4355,
    "api": 4352,
    "graphql": 4350,
    "a2a": 4351,
    "mcp": 4353,
    "database": 5432
  },
  "dependencies": ["contracts"],
  "optional": false,
  "enabled": true,
  "autoStart": true,
  "tags": ["indexer", "graphql", "data", "jns", "infrastructure", "explorer"],
  "jns": {
    "name": "indexer.jeju",
    "description": "Blockchain Indexer with GraphQL API",
    "url": "https://indexer.jejunetwork.org"
  },
  "healthCheck": {
    "url": "http://localhost:4352/health",
    "interval": 30000
  },
  "agent": {
    "enabled": true,
    "a2aEndpoint": "/a2a",
    "mcpEndpoint": "/mcp",
    "tags": ["jeju-app", "indexer", "graphql", "data", "explorer"],
    "metadata": {
      "category": "data",
      "provider": "jeju-network",
      "features": ["graphql", "subscriptions", "historical-data", "web-ui"]
    },
    "trustModels": ["open"],
    "x402Support": false,
    "jnsName": "indexer.jeju"
  },
  "dws": {
    "backend": {
      "enabled": true,
      "runtime": "bun",
      "entrypoint": "api/api-server.ts",
      "memory": 1024,
      "timeout": 60000,
      "minInstances": 1,
      "maxInstances": 5,
      "teeRequired": false,
      "regions": ["global"]
    },
    "database": {
      "type": "postgres",
      "name": "indexer-db"
    }
  },
  "decentralization": {
    "cdn": {
      "enabled": true,
      "regions": ["global"],
      "cacheRules": [
        { "pattern": "/assets/**", "ttl": 31536000, "immutable": true },
        { "pattern": "/graphql", "ttl": 0 },
        { "pattern": "/api/**", "ttl": 5 }
      ],
      "apiCaching": {
        "enabled": true,
        "defaultTtl": 5,
        "varyHeaders": ["x-jeju-address"]
      },
      "serviceWorker": true
    },
    "frontend": {
      "buildDir": "dist/web",
      "buildCommand": "bun run build",
      "spa": true,
      "jnsName": "indexer.jeju",
      "ipfs": true,
      "arweave": true,
      "cacheRules": [
        { "pattern": "/assets/**", "ttl": 31536000, "immutable": true },
        { "pattern": "/*.js", "ttl": 86400 },
        { "pattern": "/**/*.html", "ttl": 60, "staleWhileRevalidate": 3600 }
      ]
    },
    "robustness": {
      "frontendStorage": "ipfs",
      "dataStorage": "cql",
      "nodeDiscovery": "on-chain",
      "coordination": "p2p",
      "multiOrigin": true,
      "offlineSupport": true,
      "p2pFallback": true,
      "contentAddressed": true
    }
  },
  "endpoints": {
    "graphql": "/graphql",
    "rest": "/api/*",
    "a2a": "/a2a/*",
    "mcp": "/mcp/*"
  },
  "testing": {
    "unit": {
      "command": "bun run test",
      "timeout": 120000
    },
    "integration": {
      "command": "bun test --grep integration",
      "timeout": 180000,
      "requiresChain": true,
      "requiresServices": true
    },
    "e2e": {
      "command": "bunx playwright test",
      "timeout": 300000,
      "requiresChain": true
    },
    "services": ["postgres", "chain"]
  }
}
