{
  "$schema": "../../packages/config/jeju-manifest.schema.json",
  "name": "dws",
  "displayName": "Decentralized Web Services",
  "version": "1.0.0",
  "type": "core",
  "description": "Decentralized Web Services - Storage, Compute, CDN, Funding. The foundational infrastructure for all Jeju apps.",
  "commands": {
    "dev": "bun run scripts/dev.ts",
    "build": "bun build src/index.ts --outdir dist --target bun",
    "build:frontend": "cd frontend && bun run build",
    "start": "bun run src/server/index.ts",
    "test": "bun test"
  },
  "ports": {
    "main": 4030,
    "frontend": 4031
  },
  "dependencies": ["contracts", "config"],
  "optional": false,
  "enabled": true,
  "autoStart": true,
  "tags": ["dws", "storage", "compute", "cdn", "infrastructure", "core"],
  "jns": {
    "name": "dws.jeju",
    "description": "Decentralized Web Services",
    "url": "https://dws.jejunetwork.org"
  },
  "healthCheck": {
    "url": "http://localhost:4030/health",
    "interval": 30000
  },
  "agent": {
    "enabled": true,
    "a2aEndpoint": "/a2a",
    "mcpEndpoint": "/mcp",
    "tags": ["jeju-app", "dws", "storage", "compute", "cdn"],
    "metadata": {
      "category": "infrastructure",
      "provider": "jeju-network",
      "features": ["storage", "compute", "cdn", "git", "pkg", "ci", "containers"]
    },
    "trustModels": ["open", "staked"],
    "x402Support": true,
    "jnsName": "dws.jeju"
  },
  "endpoints": {
    "storage": "/storage/*",
    "compute": "/compute/*",
    "cdn": "/cdn/*",
    "git": "/git/*",
    "pkg": "/pkg/*",
    "ci": "/ci/*",
    "oauth3": "/oauth3/*",
    "api": "/api/*",
    "containers": "/containers/*",
    "a2a": "/a2a/*",
    "mcp": "/mcp/*",
    "funding": "/funding/*",
    "registry": "/registry/*"
  },
  "dws": {
    "backend": {
      "enabled": true,
      "runtime": "bun",
      "entrypoint": "src/server/index.ts",
      "memory": 2048,
      "timeout": 60000,
      "minInstances": 3,
      "maxInstances": 20,
      "teeRequired": true,
      "regions": ["global"]
    },
    "cdn": {
      "enabled": true,
      "regions": ["global"],
      "staticDir": "frontend/dist",
      "cacheRules": [
        { "pattern": "/assets/**", "ttl": 31536000, "immutable": true },
        { "pattern": "/*.js", "ttl": 86400 },
        { "pattern": "/*.css", "ttl": 86400 },
        { "pattern": "/**/*.html", "ttl": 60, "staleWhileRevalidate": 3600 }
      ]
    },
    "tee": {
      "platform": "dstack",
      "attestation": true,
      "decryption": true
    }
  },
  "decentralization": {
    "frontendStorage": "ipfs",
    "dataStorage": "cql",
    "nodeDiscovery": "on-chain",
    "coordination": "p2p",
    "execution": ["workerd", "containers", "tee"],
    "payments": "x402",
    "frontend": {
      "ipfs": true,
      "arweave": true,
      "jnsName": "dws.jeju",
      "buildDir": "frontend/dist",
      "spa": true
    },
    "robustness": {
      "multiOrigin": true,
      "offlineSupport": true,
      "p2pFallback": true,
      "contentAddressed": true
    }
  },
  "deployment": {
    "testnet": {
      "network": "jeju-testnet",
      "chainId": 420690,
      "services": {
        "dws": {
          "port": 4030,
          "replicas": 3,
          "resources": {
            "cpu": "2",
            "memory": "4Gi"
          }
        }
      }
    },
    "mainnet": {
      "network": "jeju",
      "chainId": 420691,
      "services": {
        "dws": {
          "port": 4030,
          "replicas": 5,
          "resources": {
            "cpu": "4",
            "memory": "8Gi"
          }
        }
      }
    }
  },
  "testing": {
    "unit": {
      "command": "bun run test",
      "timeout": 120000
    },
    "integration": {
      "command": "bun test tests/integration",
      "timeout": 300000,
      "requiresServices": true
    },
    "e2e": {
      "command": "bun run test:e2e",
      "timeout": 600000,
      "requiresChain": true
    }
  }
}
