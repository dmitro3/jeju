{
  "$schema": "../../packages/config/jeju-manifest.schema.json",
  "name": "dws",
  "displayName": "DWS",
  "version": "1.0.0",
  "description": "Decentralized Web Services - Storage, Compute, CDN, Funding",
  "type": "service",
  "commands": {
    "dev": "bun run dev",
    "build": "bun run build",
    "start": "bun run serve"
  },
  "ports": {
    "main": 4031,
    "api": 4030,
    "frontend": 4031
  },
  "dependencies": [
    "contracts",
    "config"
  ],
  "optional": false,
  "enabled": true,
  "autoStart": true,
  "tags": [
    "dws",
    "storage",
    "compute",
    "cdn",
    "funding",
    "infrastructure"
  ],
  "jns": {
    "name": "dws.jeju",
    "description": "Decentralized Web Services",
    "url": "https://dws.jejunetwork.org"
  },
  "healthCheck": {
    "url": "http://localhost:4030/health",
    "interval": 30000
  },
  "agent": {
    "enabled": true,
    "a2aEndpoint": "/a2a",
    "mcpEndpoint": "/mcp",
    "tags": [
      "jeju-app",
      "dws",
      "storage",
      "compute",
      "cdn"
    ],
    "metadata": {
      "category": "infrastructure",
      "provider": "jeju-network",
      "features": [
        "storage",
        "compute",
        "cdn",
        "git",
        "packages",
        "containers",
        "ci"
      ]
    },
    "trustModels": [
      "open",
      "staked"
    ],
    "x402Support": true,
    "jnsName": "dws.jeju"
  },
  "deployment": {
    "testnet": {
      "network": "jeju-testnet",
      "chainId": 420690,
      "contracts": {
        "IdentityRegistry": "${IDENTITY_REGISTRY_ADDRESS}",
        "DAORegistry": "${DAO_REGISTRY_ADDRESS}",
        "ContributorRegistry": "${CONTRIBUTOR_REGISTRY_ADDRESS}",
        "PaymentRequestRegistry": "${PAYMENT_REQUEST_REGISTRY_ADDRESS}",
        "DeepFundingDistributor": "${DEEP_FUNDING_DISTRIBUTOR_ADDRESS}",
        "JNSRegistry": "${JNS_REGISTRY_ADDRESS}"
      },
      "services": {
        "dws": {
          "port": 4030,
          "replicas": 3,
          "resources": {
            "cpu": "2",
            "memory": "4Gi"
          }
        }
      }
    },
    "mainnet": {
      "network": "jeju",
      "chainId": 420691,
      "contracts": {
        "IdentityRegistry": "${IDENTITY_REGISTRY_ADDRESS}",
        "DAORegistry": "${DAO_REGISTRY_ADDRESS}",
        "ContributorRegistry": "${CONTRIBUTOR_REGISTRY_ADDRESS}",
        "PaymentRequestRegistry": "${PAYMENT_REQUEST_REGISTRY_ADDRESS}",
        "DeepFundingDistributor": "${DEEP_FUNDING_DISTRIBUTOR_ADDRESS}",
        "JNSRegistry": "${JNS_REGISTRY_ADDRESS}"
      },
      "services": {
        "dws": {
          "port": 4030,
          "replicas": 5,
          "resources": {
            "cpu": "4",
            "memory": "8Gi"
          }
        }
      }
    },
    "localnet": {
      "network": "anvil",
      "chainId": 31337,
      "contracts": {
        "IdentityRegistry": "${IDENTITY_REGISTRY_ADDRESS}",
        "DAORegistry": "${DAO_REGISTRY_ADDRESS}",
        "ContributorRegistry": "${CONTRIBUTOR_REGISTRY_ADDRESS}",
        "PaymentRequestRegistry": "${PAYMENT_REQUEST_REGISTRY_ADDRESS}",
        "DeepFundingDistributor": "${DEEP_FUNDING_DISTRIBUTOR_ADDRESS}",
        "JNSRegistry": "${JNS_REGISTRY_ADDRESS}"
      }
    }
  },
  "dws": {
    "backend": {
      "enabled": true,
      "runtime": "workerd",
      "entrypoint": "api/worker.ts",
      "memory": 512,
      "timeout": 30000,
      "minInstances": 3,
      "maxInstances": 100,
      "teeRequired": false,
      "regions": ["global"],
      "env": {
        "GENESIS_MODE": "false"
      }
    },
    "bootstrap": {
      "enabled": true,
      "genesisNodes": 3,
      "genesisRuntime": "bun",
      "genesisEntrypoint": "api/server/index.ts",
      "description": "Genesis nodes run full DWS with system access for workerd process management, git repos, and containers"
    },
    "cdn": {
      "enabled": true,
      "regions": ["global"],
      "staticDir": "dist",
      "cacheRules": [
        { "pattern": "/assets/**", "ttl": 31536000, "immutable": true },
        { "pattern": "/*.js", "ttl": 86400 },
        { "pattern": "/**/*.html", "ttl": 60, "staleWhileRevalidate": 3600 }
      ]
    },
    "database": {
      "type": "sqlit",
      "name": "dws-core"
    }
  },
  "endpoints": {
    "storage": "/storage/*",
    "compute": "/compute/*",
    "cdn": "/cdn/*",
    "git": "/git/*",
    "pkg": "/pkg/*",
    "ci": "/ci/*",
    "oauth3": "/oauth3/*",
    "api": "/api/*",
    "containers": "/containers/*",
    "a2a": "/a2a/*",
    "mcp": "/mcp/*",
    "funding": "/funding/*",
    "registry": "/registry/*",
    "workerd": "/workerd/*",
    "sqlit": "/sqlit/*",
    "nodes": "/nodes/*",
    "kms": "/kms/*"
  },
  "decentralization": {
    "worker": {
      "name": "dws-api",
      "entrypoint": "api/worker.ts",
      "runtime": "workerd",
      "memory": 512,
      "timeout": 30000,
      "compatibilityDate": "2025-06-01",
      "secrets": [
        "OPENAI_API_KEY",
        "ANTHROPIC_API_KEY",
        "GROQ_API_KEY",
        "TOGETHER_API_KEY",
        "OPENROUTER_API_KEY",
        "FIREWORKS_API_KEY",
        "MISTRAL_API_KEY",
        "DEEPSEEK_API_KEY",
        "CEREBRAS_API_KEY",
        "PERPLEXITY_API_KEY",
        "SAMBANOVA_API_KEY",
        "AI21_API_KEY",
        "XAI_API_KEY",
        "COHERE_API_KEY",
        "GOOGLE_AI_API_KEY",
        "FAL_API_KEY",
        "REPLICATE_API_KEY"
      ],
      "routes": [
        { "pattern": "/api/*" },
        { "pattern": "/storage/*" },
        { "pattern": "/workers/*" },
        { "pattern": "/workerd/*" },
        { "pattern": "/sqlit/*" },
        { "pattern": "/cdn/*" },
        { "pattern": "/apps/*" },
        { "pattern": "/a2a/*" },
        { "pattern": "/mcp/*" },
        { "pattern": "/health" },
        { "pattern": "/auth/*" },
        { "pattern": "/account/*" },
        { "pattern": "/secrets/*" },
        { "pattern": "/logs/*" },
        { "pattern": "/previews/*" },
        { "pattern": "/vault/*" }
      ]
    },
    "frontend": {
      "buildDir": "dist",
      "buildCommand": "bun run build",
      "spa": true,
      "jnsName": "dws.jeju",
      "ipfs": true,
      "arweave": false,
      "cacheRules": [
        {
          "pattern": "/assets/**",
          "ttl": 31536000,
          "immutable": true
        },
        {
          "pattern": "/*.js",
          "ttl": 86400
        },
        {
          "pattern": "/**/*.html",
          "ttl": 60,
          "staleWhileRevalidate": 3600
        }
      ]
    },
    "robustness": {
      "frontendStorage": "ipfs",
      "dataStorage": "sqlit",
      "nodeDiscovery": "on-chain",
      "coordination": "p2p",
      "execution": [
        "workerd",
        "containers",
        "tee"
      ],
      "payments": "x402"
    }
  },
  "architecture": {
    "type": "hybrid",
    "frontend": {
      "type": "spa",
      "builder": "bun",
      "entrypoint": "index.html",
      "outputDir": "dist"
    }
  }
}
