{
  "$schema": "../../packages/config/jeju-manifest.schema.json",
  "name": "gateway",
  "displayName": "Gateway",
  "version": "1.0.0",
  "type": "core",
  "description": "Protocol Infrastructure Hub: Bridge tokens, deploy paymasters, provide ETH liquidity, run nodes, earn rewards, cross-chain intents. Supports any ERC20. Protocol power = paymaster + liquidity.",
  "commands": {
    "dev": "bun run dev",
    "build": "bun run build",
    "start": "bun run start",
    "start:worker": "bun run start:worker",
    "solver": "bun src/solver/index.ts"
  },
  "ports": {
    "main": 4013,
    "frontend": 4014,
    "a2a": 4013,
    "ws": 4015
  },
  "dependencies": [
    "contracts",
    "config",
    "dws"
  ],
  "optional": false,
  "enabled": true,
  "autoStart": true,
  "tags": [
    "protocol",
    "infrastructure",
    "paymaster",
    "nodes",
    "staking",
    "liquidity",
    "multi-token",
    "intents",
    "cross-chain",
    "oif",
    "aggregator",
    "solver"
  ],
  "jns": {
    "name": "gateway.jeju",
    "description": "Protocol Infrastructure Hub for the Network",
    "url": "https://gateway.jejunetwork.org"
  },
  "healthCheck": {
    "url": "http://localhost:4013/health",
    "interval": 30000
  },
  "agent": {
    "enabled": true,
    "a2aEndpoint": "/a2a",
    "mcpEndpoint": "/mcp",
    "tags": [
      "jeju-app",
      "protocol",
      "infrastructure",
      "nodes",
      "staking",
      "intents",
      "cross-chain",
      "oif"
    ],
    "metadata": {
      "category": "infrastructure",
      "provider": "jeju-network",
      "features": [
        "bridge",
        "paymaster",
        "liquidity",
        "solver",
        "intents"
      ]
    },
    "trustModels": [
      "open"
    ],
    "x402Support": true,
    "jnsName": "gateway.jeju"
  },
  "dws": {
    "backend": {
      "enabled": true,
      "runtime": "workerd",
      "entrypoint": "api/worker.ts",
      "memory": 512,
      "timeout": 30000,
      "minInstances": 1,
      "maxInstances": 10,
      "teeRequired": false,
      "regions": [
        "global"
      ]
    },
    "cdn": {
      "enabled": true,
      "regions": [
        "global"
      ],
      "staticDir": "dist",
      "cacheRules": [
        {
          "pattern": "/assets/**",
          "ttl": 31536000,
          "immutable": true
        },
        {
          "pattern": "/*.js",
          "ttl": 86400
        },
        {
          "pattern": "/*.css",
          "ttl": 86400
        },
        {
          "pattern": "/**/*.html",
          "ttl": 60,
          "staleWhileRevalidate": 3600
        }
      ]
    }
  },
  "decentralization": {
    "worker": {
      "name": "gateway-api",
      "entrypoint": "api/worker.ts",
      "runtime": "workerd",
      "memory": 512,
      "timeout": 60000,
      "compatibilityDate": "2024-01-01",
      "compatibilityFlags": [
        "nodejs_compat"
      ],
      "bindings": {
        "GATEWAY_CACHE": {
          "type": "kv",
          "name": "gateway-cache-kv"
        }
      },
      "kms": {
        "serviceIds": [
          "faucet",
          "x402-facilitator",
          "oracle-operator",
          "oracle-worker",
          "leaderboard-oracle"
        ],
        "secrets": [
          "service-auth-secret",
          "internal-rpc-api-key",
          "github-token",
          "openrouter-api-key"
        ]
      },
      "routes": [
        {
          "pattern": "/.well-known/*"
        },
        {
          "pattern": "/api/*"
        },
        {
          "pattern": "/rpc/*"
        },
        {
          "pattern": "/x402/*"
        },
        {
          "pattern": "/oracle/*"
        },
        {
          "pattern": "/leaderboard/*"
        },
        {
          "pattern": "/a2a/*"
        },
        {
          "pattern": "/mcp/*"
        },
        {
          "pattern": "/health"
        }
      ]
    },
    "frontend": {
      "buildDir": "dist",
      "buildCommand": "bun run build",
      "spa": true,
      "jnsName": "gateway.jeju",
      "ipfs": true,
      "arweave": true,
      "cacheRules": [
        {
          "pattern": "/assets/**",
          "ttl": 31536000,
          "immutable": true
        },
        {
          "pattern": "/*.js",
          "ttl": 86400
        },
        {
          "pattern": "/*.css",
          "ttl": 86400
        },
        {
          "pattern": "/**/*.html",
          "ttl": 60,
          "staleWhileRevalidate": 3600
        }
      ]
    },
    "cdn": {
      "enabled": true,
      "regions": [
        "global"
      ],
      "cacheRules": [
        {
          "pattern": "/assets/**",
          "ttl": 31536000,
          "immutable": true
        },
        {
          "pattern": "/api/quotes/**",
          "ttl": 2,
          "staleWhileRevalidate": 10
        },
        {
          "pattern": "/api/prices/**",
          "ttl": 5
        },
        {
          "pattern": "/api/**",
          "ttl": 0
        },
        {
          "pattern": "/**/*.html",
          "ttl": 60,
          "staleWhileRevalidate": 3600
        }
      ],
      "apiCaching": {
        "enabled": true,
        "defaultTtl": 5,
        "varyHeaders": [
          "x-jeju-address",
          "x-chain-id"
        ]
      },
      "serviceWorker": true
    },
    "robustness": {
      "multiOrigin": true,
      "offlineSupport": true,
      "p2pFallback": true,
      "contentAddressed": true
    }
  },
  "testing": {
    "unit": {
      "command": "bun run test:unit",
      "timeout": 120000
    },
    "integration": {
      "command": "bun run test:integration",
      "timeout": 300000,
      "requiresChain": true
    },
    "e2e": {
      "command": "bunx playwright test tests/synpress/",
      "config": "synpress.config.ts",
      "timeout": 600000,
      "requiresChain": true,
      "requiresWallet": true
    },
    "services": [
      "contracts"
    ]
  },
  "architecture": {
    "type": "hybrid",
    "frontend": {
      "type": "spa",
      "builder": "bun",
      "entrypoint": "index.html",
      "outputDir": "dist"
    },
    "backend": {
      "outputDir": "dist/worker",
      "entrypoint": "api/worker.ts",
      "startCmd": "dev:worker"
    }
  }
}
